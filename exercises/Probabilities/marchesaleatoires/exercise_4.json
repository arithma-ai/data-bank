{
    "script": "Un appartement est formé de deux pièces $A$ et $B$  reliées entre elles par une porte ouverte.\r\nSeule la pièce $B$ possède une fenêtre ouverte. Une guêpe, qui s'était endormie dans la pièce $A$ se réveille à l'instant 0. On estime que :quand la guêpe est dans la pièce $A$ à l'instant $n$ (exprimé en minutes), elle est encore dans cette pièce une minute après avec probabilité 1/3.quand la guêpe est dans la pièce $B$ à l'instant $n$, elle retourne dans la pièce $A$ une minute après avec probabilité 1/4 et reste dans la pièce $B$ avec probabilité 1/2.Dans cette question, quand la guêpe sort de l'appartement, elle ne revient plus. On introduit les évènements$A_n$ : \"la guêpe est dans la pièce $A$ à l'instant $n$''$B_n$ : \"la guêpe est dans la pièce $B$ à l'instant $n$''$E_n$ : ''la guêpe est à l'extérieur de l'appartement à l'instant $n$\".Enfin, on note $a_n$, $b_n$ et $e_n$ les probabilités respectives de ces évènements et $U_n=\\begin{pmatrix}a_n\\\\b_n\\\\e_n\\end{pmatrix}$.Décrire la matrice de transition $M$ telle que pour tout $n\\ge 0$, $U_{n+1}=MU_n$.On note $X_n=\\begin{pmatrix}a_n\\\\b_n\\end{pmatrix}$.\r\nMontrer qu'il existe une matrice $Q$ que l'on déterminera telle que pour tout $n\\ge 0$, $X_{n+1}=QX_n$.Montrer qu'il existe un réel $\\lambda$ que l'on déterminera tel que $Q^2=\\lambda Q$.Calculer la probabilité que, $n$ minutes après son réveil,  la guêpe ne se trouve plus dans l'appartement.Au bout de combien de temps, cette probabilité devient-elle supérieure à 0,999 ?On note $T$ le premier instant où la guêpe se trouve à l'extérieur de l'appartement. Que vaut $P(T=1)$ ? Pour $n\\ge 2$, calculer $P(T=n)$.Que représente $e_n$ vis à vis de la variable aléatoire $T$ ?Montrer que $P(T<+\\infty)=1$.On suppose maintenant que, lorsque la guêpe est sortie, elle revient dans la pièce $B$ avec probabilité 0,1. Les notations sont les mêmes que lors de la question 1.Que devient la matrice de transition $M$ dans cette situation ?(Question bonus) Donner, sous un logiciel de calcul formel de votre choix, les commandes permettant d'obtenir les valeurs propres et les vecteurs propres de la matrice $M$.L'utilisation de Xcas donne les valeurs propres suivantes pour $M$ \r\n$$1,(-\\sqrt{514}+22)/60,(\\sqrt{514}+22)/60$$\r\nainsi que les vecteurs propres associés\r\n$$\\begin{pmatrix} \r\n3 & 2\\sqrt{514}+34&-2\\sqrt{514}+34\\\\\r\n8&-2\\sqrt{514}-64&2\\sqrt{514}-64\\\\\r\n20&30&30\r\n\\end{pmatrix}\r\n$$\r\nEn déduire que la suite $(U_n)$ converge.On note $U_\\infty$ la limite de la suite $(U_n)$. Justifier que $U_\\infty=MU_\\infty$ et en déduire la valeur de $U_\\infty$.",
    "hint": "Chercher les probabilités manquantes...Il suffit d'extraire...Montrer qu'il existe un réel $\\lambda$ que l'on déterminera tel que $Q^2=\\lambda Q$.La question précédente permet facilement de calculer $Q^n$, et donc $a_n$ et $b_n$...Passer au logarithme pour résoudre l'inéquation.Lier l'événement $T=n$ et l'événement $B_{n-1}$.La guêpe est dehors à l'instant $n$ si et seulement si elle est sortie à un instant précédent.$(e_n)$ tend vers 0.On suppose maintenant que, lorsque la guêpe est sortie, elle revient dans la pièce $B$ avec probabilité 0,1. Les notations sont les mêmes que lors de la question 1.Cf une question précédente.Les autres valeurs propres sont de module inférieur strict à $1$.Passer à la limite dans $U_{n+1}=MU_n$, puis utiliser le calcul des vecteurs propres donné par XCas.",
    "solution": "L'énoncé nous donne \r\n$$P(A_{n+1}|A_n)=\\frac 13,\\ P(E_{n+1}|A_n)=0$$\r\n$$P(A_{n+1}|B_n)=\\frac 14,\\ P(B_{n+1}|B_n)=\\frac 12$$\r\n$$P(E_{n+1}|E_n)=1.$$\r\nSachant que \r\n$$P(A_{n+1}|A_n)+P(B_{n+1}|A_n)+P(E_{n+1}|A_n)=1$$\r\non trouve\r\n$$P(B_{n+1}|A_n)=\\frac 23.$$\r\nDe même on a\r\n$$P(E_{n+1}|B_n)=\\frac 14$$\r\net \r\n$$P(A_{n+1}|E_n)=P(B_{n+1}|E_n)=0.$$\r\nLa matrice de transition $M$ est donc \r\n$$M=\\begin{pmatrix}\r\n1/3&1/4&0\\\\\r\n2/3&1/2&0\\\\\r\n0&1/4&1\r\n\\end{pmatrix}.$$Il suffit d'extraire...\r\n$$Q=\\begin{pmatrix}\r\n1/3&1/4\\\\\r\n2/3&1/2\r\n\\end{pmatrix}.$$On passe au carré et on trouve\r\n$$Q^2=\\begin{pmatrix}\r\n5/18&5/24\\\\\r\n5/9&5/12\r\n\\end{pmatrix}=\\frac 56 Q.$$On cherche donc $e_n=1-a_n-b_n$. Mais on sait d'après la question précédente que \r\n$$Q^n=\\left(\\frac 56\\right)^{n-1}Q.$$\r\nPuisque $X_n=Q^n X_0$ et que l'énoncé nous dit que $a_0=1$ et $b_0=0$, on en déduit\r\n\\begin{eqnarray*}\r\na_n&=&\\frac 13\\times\\left(\\frac 56\\right)^{n-1}\\\\\r\nb_n&=&\\frac 23\\times\\left(\\frac 56\\right)^{n-1}.\r\n\\end{eqnarray*}\r\nIl vient donc\r\n$$e_n=1-\\frac 13\\times\\left(\\frac 56\\right)^{n-1}-\\frac 23\\times\\left(\\frac 56\\right)^{n-1}=1-\\left(\\frac 56\\right)^{n-1}.$$On cherche le premier instant $n$ tel que $e_n\\geq 0,999$.\r\nCeci est équivalent à \r\n$$\\left(\\frac 56\\right)^{n-1}\\leq 10^{-3}$$\r\nou encore, en passant au logarithme, \r\n$$n\\geq 1+\\frac{\\ln\\left(10^{-3}\\right)}{\\ln(5/6)}.$$\r\nOn trouve $n\\geq 40$.On a $P(T=1)=0$ car après une minute, la guêpe ne peut être qu'en $A$ ou en $B$. Pour $n\\geq 2$, l'événement $T=n$ est réalisé si l'événement $B_{n-1}$ est réalisé et que le mouvement de la guêpe se fait vers l'extérieur. On en déduit que \r\n$$P(T=n)=\\frac14b_{n-1}=\\frac 16\\left(\\frac 56\\right)^{n-2}.$$L'événement $E_n$ est réalisé si et seulement si l'un des événements disjoints $\"T=k\"$ est réalisé, pour $k=2,\\dots,n$. On a donc \r\n$$e_n=\\sum_{k=2}^n P(T=k).$$\r\nOn peut d'ailleurs vérifier que cette formule est juste en s'aidant des valeurs de $e_n$ et de $P(T=k)$ calculés plus haut, et de la formule donnant la valeur d'une somme géométrique.Posons $U_n$ l'événement $T\\leq n$. Alors les événements $U_n$ sont croissants et leur réunion est \r\n$T<+\\infty$. On a donc \r\n$$P(T<+\\infty)=\\lim_{n\\to+\\infty}P(T\\leq n)=\\lim_{n\\to+\\infty}\\sum_{k=2}^n P(T=k)=\\lim_{n\\to+\\infty}e_n=0.$$On refait le même travail, et la matrice de transition est cette fois :\r\n$$M=\\begin{pmatrix}\r\n1/3&1/4&0\\\\\r\n2/3&1/2&1/10\\\\\r\n0&1/4&9/10\r\n\\end{pmatrix}.$$Par exemple sous Xcas, on peut entrer :M:=[ [1/3, 1/4,0], [2/3,1/2,1/10], [0,1/4,9/10] ];eigenvals(A);eigenvects(A);On vérifie à l'aide de la calculatrice que les deux valeurs propres différentes de 1 sont de module inférieur strict à $1$. Notons $D$ la matrice diagonale dont les coefficients diagonaux sont $1,-\\sqrt{514}+22)/60,(\\sqrt{514}+22)/60$ et $P$ la matrice de passage. On a $M=PDP^{-1}$, et donc \r\n$M^n=PD^nP^{-1}$. Puisque la suite $D^n$ converge la matrice diagonale $D_1$ dont les coefficients diagonaux sont $1,0,0$, la suite $M^n$ tend vers $M_\\infty$ et donc la suite $(U_n)$ converge vers $U_\\infty=M_{\\infty}U_0$.Il n'est heureusement pas nécessaire de calculer $M_\\infty$ pour trouver $U_\\infty$. En effet, passant à la limite dans $U_{n+1}=MU_n$, on trouve $U_{\\infty}=MU_{\\infty}$. Ainsi, $U_\\infty$ est une valeur propre de $M$ associée à la valeur propre $1$. Par le calcul effectué sous Xcas, on sait que $U_\\infty=(a,b,c)$ est proportionnel à $(3,8,20)$. De plus, on sait que $a+b+c=1$, et donc \r\n$$U_\\infty=\\begin{pmatrix}\r\n\\frac{3}{31}\\\\\r\n\\frac 8{31}\\\\\r\n\\frac{20}{31}\r\n\\end{pmatrix}.$$",
    "lang": "french"
}
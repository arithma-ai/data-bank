{
    "script": "On considère une série statistique double $\\{(x_i,y_i)_{1\\leq i\\leq n}\\}$ vue comme $n$ points de $\\mathbb R^2$ et on note $M_i$ le point de coordonnées $(x_i,y_i)$. \r\nOn cherche une droite de la forme $y=ax+b$ qui réalise le \"meilleur ajustement\" possible du nuage. La méthode des moindres carrés consiste à à dire que le meilleur ajustement est réalisé lorsque la somme des carrés des distances de $M_i$ à $H_i$ (le projeté de $M_i$ sur la droite $y=ax+b$ parallèlement à l'axe des ordonnées) est minimale. Autrement dit, on cherche à minimiser la quantité suivante :\r\n$$T(a,b)=\\sum_{i=1}^n (y_i-ax_i-b)^2.$$\r\nOn va prouver dans cet exercice le résultat suivant :Si $\\sigma_x\\neq 0$, il existe une unique droite d'équation $y=ax+b$ minimisant la quantité $T(a,b)$. De plus, \r\n$$a=\\frac{\\sigma_{x,y}}{\\sigma_x^2}\\textrm{ et }b=\\bar y-\\bar x\\frac{\\sigma_{x,y}}{\\sigma_x^2}.$$Pourquoi impose-t-on la condition $\\sigma_x\\neq 0$?Méthode 1 : par un calcul directOn suppose pour commencer que $\\bar x=0$ et que $\\bar y=0$. Démontrer que \r\n$$T(a,b)=\\sum_{i=1}^n y_i^2+a^2\\sum_{i=1}^n x_i^2-2a\\sum_{i=1}^n x_iy_i+nb^2.$$En déduire que $T(a,b)$ est minimum si et seulement si $a=\\frac{\\sigma_{x,y}}{\\sigma_x^2}$ et $b=0$.Cas général : on pose $x'_i=x_i-\\bar x$, $y'_i=y-\\bar y$ et $U(a,b)=\\sum_{i=1}^n (y'_i-ax'_i-b)^2$. Démontrer que $T(a,b)=U(a,b-\\bar y+a\\bar x)$.Conclure.Méthode 2 : par projection orthogonale. On munit $\\mathbb R^n$ de son produit scalaire canonique.Soit $\\vec y$ un vecteur de $\\mathbb R^n$ et $F$ un plan vectoriel (de dimension $2$). Démontrer que \r\n$$\\inf \\{\\|\\vec y-\\vec z\\|;\\ \\vec z\\in F\\}=\\|\\vec y-p_F(\\vec y)\\|$$\r\noù $p_F(\\vec y)$ est le projeté orthogonal de $\\vec y$ sur $F$ (conseil : utiliser le théorème de Pythagore).On note $\\vec x=(x_1,\\dots,x_n)$, $\\vec y=(y_1,\\dots,y_n)$ et $\\vec u=(1,\\dots,1)$. Déterminer $a$ et $b$ de sorte\r\nque $a\\vec x+b\\vec u$ soit le projeté orthogonal de $\\vec y$ sur $\\textrm{vect}(\\vec x,\\vec u)$.Vérifier que $T(a,b)=\\|\\vec y-(a\\vec x+b\\vec u)\\|^2$.Conclure.",
    "hint": "Alignement de points.Développer tout et remarquer qu'un terme disparait par l'hypothèse faite.Ajouter et soustraire $a \\bar x$ et $\\bar y$ dans la somme.Minimiser $U$ pour minimiser $T$.Écrire $\\vec y-\\vec z=\\vec y-p_F(\\vec y)+p_F(\\vec y)-\\vec z$.Écrire que $\\vec y-(a\\vec x+b\\vec u)$ est orthogonal à $\\vec x$ et à $\\vec u$ et résoudre le système $2\\times 2$.",
    "solution": "Si $\\sigma_x=0$, alors tous les $x_i$ seraient égaux et donc tous les points seraient alignés sur une droite verticale. En particulier, il serait absurde de rechercher une meilleure droite d'ajustement d'équation $y=ax+b$, qui n'est donc pas verticale.On a en développant tout\r\n$$T(a,b)=\\sum_{i=1}^n y_i^2+a^2\\sum_{i=1}^n x_i^2-2a\\sum_{i=1}^n x_iy_i-2b\\sum_{i=1}^n (y_i-ax_i)+nb^2.$$\r\nMaintenant, puisque $\\bar x=\\bar y=0$, on a $\\sum_{i=1}^n(y_i-ax_i)=0$ ce qui donne le résultat.On remarque que $T(a,b)=f(a)+g(b)$ avec $f(a)=a^2\\sum_{i=1}^n x_i^2-2a\\sum_{i=1}^n x_iy_i+\\sum_{i=1}^n y_i^2$ et $b(b)=nb^2$. Ainsi, $T(a,b)$ est minimum si et seulement si $f$ est minimum et $g$ est minimum (on a séparé l'étude pour chaque variable). Clairement, $g$ est minimum en $b$ si et seulement si $b=0$. D'autre part, $f$ est un polynôme de degré 2 en $a$, qui est minimum uniquement là où sa dérivée s'annule, c'est-à-dire en\r\n$$a=\\frac{\\sum_{i=1}^n x_iy_i}{\\sum_{i=1}^n x_i^2}=\\frac{\\sigma_{x,y}}{\\sigma_x^2}.$$Il suffit de remarquer que \r\n$$T(a,b)=\\sum_{i=1}^n \\left(y_i-\\bar y-a(x_i-\\bar x)+b-\\bar y+a\\bar x\\right)=U(a,b-\\bar y+a\\bar x).$$On en déduit que $T(a,b)$ est minimal si et seulement si $U(a,b-\\bar y+a\\bar x)$ est minimal. Or, la moyenne respective des $x'_i$ et des $y'_i$ sont nulles, et donc $U(a,b-\\bar y+a\\bar x)$ est minimal si et seulement si $a=\\frac{\\sigma_{x',y'}}{\\sigma_{x'}^2}$ et $b=\\bar y-a\\bar x$. On conclut en remarquant que $\\sigma_x=\\sigma_{x'}$ et $\\sigma_{x,y}=\\sigma_{x',y'}$.Soit $\\vec z$ un vecteur de $F$. On écrit \r\n$$\\vec y-\\vec z=\\vec y-p_F(\\vec y)+p_F(\\vec y)-\\vec z.$$ \r\nOr, par définition du projeté orthogonal, $\\vec y-p_F(\\vec y)$ est orthogonal à $F$, en particulier à\r\n$p_F(\\vec y)-\\vec z$. Par le théorème de Pythagore, on a \r\n$$\\|\\vec y-\\vec z\\|^2=\\|\\vec y-p_F(\\vec y)\\|^2+\\|p_F(\\vec y)-\\vec z\\|^2\\geq \\|\\vec y-p_F(\\vec y)\\|^2$$\r\nce qui prouve le résultat.Le vecteur $\\vec y-(a\\vec x+b\\vec u)$ doit être orthogonal à $\\vec x$ et à $\\vec u$. Mais\r\n$$\\big(\\vec y-(a\\vec x+b\\vec u)\\big)\\cdot \\vec x=0\\iff a\\|x\\|^2+b\\vec u\\cdot \\vec x=\\vec y\\cdot \\vec x$$\r\n$$\\big(\\vec y-(a\\vec x+b\\vec u)\\big)\\cdot \\vec u=0\\iff a\\vec x\\cdot\\vec u+bn=\\vec y\\cdot \\vec u.$$\r\nOn résoud ce système $2\\times 2$ (en $a$ et $b$) dont les solutions sont données par \r\n$$a=\\frac{\\sigma_{x,y}}{\\sigma_x^2}\\textrm{ et }b=\\bar y-\\bar x\\frac{\\sigma_{x,y}}{\\sigma_x^2}.$$C'est immédiat.$T(a,b)$ est minimal si et seulement si $\\|\\vec y-(a\\vec x+b\\vec u)\\|$ est minimal, si et seulement si $a\\vec x+b\\vec u$ est le projeté orthogonal de $\\vec y$ sur $\\textrm{vect}(\\vec x,\\vec u)$ , si et seulement si\r\n$$a=\\frac{\\sigma_{x,y}}{\\sigma_x^2}\\textrm{ et }b=\\bar y-\\bar x\\frac{\\sigma_{x,y}}{\\sigma_x^2}.$$",
    "lang": "french"
}
{
    "script": "Une particule se trouve à l'instant 0 au point d'abscisse $a$ ($a$ entier), sur un segment gradué de $0$ à $N$ (on suppose donc $0\\leq a\\leq N$).\r\nA chaque instant, elle fait un bond de $+1$ avec la probabilité $p$ ($0<p<1/2$), ou un bond de $-1$ avec la probabilité $q=1-p$.\r\nAutrement dit, si $x_n$ est l'abscisse de la particule à l'instant $n$, on a :\r\n$$x_{n+1}=\\left\\{\\begin{array}{ll}\r\nx_n+1&\\textrm{avec probabilité $p$}\\\\\r\nx_n-1&\\textrm{avec probabilité $1-p$.}\r\n\\end{array}\\right.$$\r\nLe processus se termine lorsque la particule atteint une des extrémités du segment (i.e. s'il existe $x_n$ avec $x_n=0$ ou $x_n=N$).Écrire une fonction python $\\verb+puce(a,N,p)+$ qui simule cette marche aléatoire et qui retourne l'endroit où la puce sort du segment ($0$ ou $N$) et le nombre de pas nécessaires pour que le processus s'arrête.On note $u_a$ la probabilité pour que la particule partant de $a$, le processus s'arrête en $0$.Que vaut $u_0$? $u_N$?Montrer que si $0<a<N$, alors $u_a={pu_{a+1}}+qu_{a-1}$.En déduire l'expression exacte de $u_a$.On note $v_a$ la probabilité pour que la particule partant de $a$, le processus s'arrête en $N$. Reprendre les questions précédentes avec $v_a$ au lieu de $u_a$.Calculer $u_a+v_a$. Qu'en déduisez-vous?",
    "hint": "Il suffit de décrypter l'énoncé.Si la particule atteint le point $a+1$, la probabilité que le processus s'arrête en 0 vaut $u_{a+1}$. Appliquer la formule des probabilités totales.Réviser les suites récurrentes d'ordre 2.Les mêmes indications que celles de la question précédente conviennent!Que dire d'un événement de probabilité 1?",
    "solution": "Voici un exemple de fonction.import randomdef puce(a,N,p):pas=0position=awhile ( (position>0) and (position<N) ):if (random.random()<p):position=position+1else:position=position-1pas=pas+1return (position,pas)Par définition, on a $u_0=1$ (le processus commence en $0$, il s'arrête immédiatement, en 0), et $u_N=0$ (le processus commence en $N$, il s'arrête aussitôt, en $N$).On note $A$ l'événement : \"Partant de $a$, le processus s'arrête en 0\", $B$ l'événement : \"Partant de $a$ à l'instant 0, à l'instant 1, la particule est en $a+1$\", et $C$ l'événement : \"Partant de $a$ à l'instant 0, à l'instant 1, la particule est en $a-1$\", de sorte que $C=\\bar B$. Par la formule des probabilités totales :\r\n$$P(A)=P(B)P(A|B)+P(C)P(A|C).$$\r\nMaintenant, puisqu'on part à l'instant $t=0$ de $a$, on a $P(B)=p$ et $P(C)=q$. D'autre part, si la particule est à l'instant 1 en $a+1$, la probabilité que le processus s'arrête en 0 vaut $u_{a+1}$. On a donc : \r\n$P(A|B)=u_{a+1}$, et de même $P(A|C)=u_{a-1}$. On en déduit la formule de récurrence :\r\n$$u_a=pu_{a+1}+qu_{a-1}.$$Pour $a$ allant de $1$ à $N-1$, la suite $(u_a)$ vérifie la formule de récurrence :\r\n$$u_{a+1}=\\frac{1}{p}u_a-\\frac{q}{p}u_{a-1}.$$\r\nL'équation caractéristique de cette récurrence est :\r\n$$r^2-\\frac{1}{p}r+\\frac{q}{p}=0.$$\r\nCette équation du second degré admet deux solutions distinctes,\r\n$$r_1=1\\textrm{ et }r_2=\\frac{q}{p}$$\r\n(remarquer ici l'utilisation de l'hypothèse $p\\neq 1/2$ qui permet d'affirmer que les deux racines sont distinctes).\r\nIl existe donc des réels $\\lambda$ et $\\mu$ tels que, pour tout $a$ dans $\\{0,\\dots,N\\}$, on ait :\r\n$$u_a=\\lambda+\\mu\\left(\\frac{q}{p}\\right)^a.$$\r\nUtilisant que $u_0=1$ et $u_N=0$, on obtient :\r\n$$u_a=\\frac{q^N}{q^N-p^N}+\\frac{p^N}{p^N-q^N}\\left(\\frac{q}{p}\\right)^a.$$Le même raisonnement prouve que :\r\n$$v_a=pv_{a+1}+qv_{a-1}.$$\r\nLa résolution de cette récurrence donne :\r\n$$v_a=\\frac{p^N}{p^N-q^N}+\\frac{p^N}{q^N-p^N}\\left(\\frac{q}{p}\\right)^a.$$On vérifie aisément que $u_a+v_a=1$. Ceci signifie que, presque sûrement, le processus va s'arrêter.",
    "lang": "french"
}